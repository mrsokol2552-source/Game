# Near-Term (2–4 Weeks)

Выделенные приоритетные задачи, извлечённые из материалов. Требуют уточнения и разбивки на тикеты при старте спринта.

## 1) Solution / namespaces
### 10) 2 недели старта — усиленная версия (план) (1) Solution / namespaces)
- - **Tilemap**: базовые слои — `Chunk` (дёшево по draw calls); слои, между которыми должны «проходить» спрайты, — `Individual` + Sprite Atlas для корректного сортинга и батчинга citeturn3search13turn3search0.
- - **Profiler/Frame Debugger** — ставьте «контрольные точки» прогресса, иначе оптимизировать будет нечего измерять citeturn3search11turn3search1.
- - **Jobs/Burst**: храните сетку/поля в `NativeArray<float>`; Burst не дружит с управляемыми массивами — это нормально, так задумано citeturn6search20.
- - **Addressables**: «зеркальте» загрузки выгрузками (иначе память распухает), группируйте по способам загрузки/частоте использования citeturn2search10turn2search16.

## Дополнение к плану разработки игры: Экономика, логистика и фортификации
### 1) Ресурсы и базовые правила (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. Ввести **4 базовых ресурса**:
- - **Труда-часы (LaborHours)** мирного населения — универсальный производственный ресурс.
- - **Энергия (Power)** — объём электро-генерации/потребления за сутки.
- - **Материалы (Materials)** — стройматериалы/детали/боекомплект (унифицированно).
- - **Еда (Food)** — снабжение гражданских и военных.
- 2. **Суточный тик** экономики: расчёт происходит раз в игровой день в строго определённом порядке (см. §9).
- 3. Для каждого здания задать: **стоимость постройки**, **время строительства**, **штатную потребность в труда-часах**, **потребление/выработку энергии**, **обслуживание**, **прирост/переработку ресурсов**.
- 4. Нельзя уходить в минус по ресурсам. При дефиците система **автоматически снижает приоритетные расходы** (см. §10).
### 2) Рост населения и конверсия в военных (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. Ввести **общий суточный прирост** мирного населения `CivGrowth` (ед./день).
- 2. Прирост формирует **пул свободных гражданских** (в труда-часах: `LaborHours = CivFree * HoursPerCivPerDay`).
- 3. Постройками типа **Призывной пункт/Казармы** конвертировать часть прироста в **военных**:
- - Параметры конверсии: **лимит обучаемых в день**, **время подготовки**, **стоимость в еде/материалах/энергии/труда-часах**.
- - Итог: военный юнит поступает в резерв/гарнизон после завершения обучения.
### 3) Передача процентов суточного прироста ИИ (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. Для каждого ресурса (включая **CivGrowth**) добавить **слайдер % передачи ИИ** (0–100%, шаг 1%).
- 2. Передача применяется **к чистому суточному приросту** до поступления в склад игрока.
- 3. Округление вниз до целых; остаток остаётся у игрока.
- 4. Конфиг хранить помодно: **общие проценты** + возможность **переписать по фракции ИИ** (при наличии нескольких ИИ).
### 4) Типы зданий (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. **Экономические**: Электростанция, Ферма, Шахта/Завод, Склад/Аккумулятор.
- 2. **Исследовательские**: Лаборатория/Университет — открывают апгрейды, повышают эффективность.
- 3. **Производственные юнитов**: Казармы/Завод техники/Аэродром — создают боевые юниты, требуют материалы, энергию, труда-часы и еду на содержании.
### 5) Транспорт как механика, не прямое управление (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. Ввести **логистические узлы** (Город/Станция/Порт/Аэродром) и **коридоры** (дорога/железная дорога/воздушный мост).
- 2. Игрок создаёт **приказы переброски**: «откуда-куда», **приоритет**, **цель прибытия**.
- 3. Система считает **время в пути** с учётом пропускной способности коридоров и узких мест; юниты перемещаются **автоматически**.
- 4. Поддержать **резервирование транспорта** (авто-маршрутизация, перенос очереди) и **ускоренную переброску** с повышенным расходом ресурсов.
### 6) Возведение фортификаций юнитами (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. Разделить на **временные** (окоп, пункт наблюдения, мешки с песком) и **постоянные** (ДОТ/бункер, капонир, противотанковый ров/ежи).
- 2. Каждой позиции задать: **стоимость** (труда-часы, материалы, иногда энергия), **время постройки**, **уровень защиты/укрытия**, **обслуживание/депрекация**.
- 3. Инструменты строительства:
- - **Линейное строительство** (траншеи по полилинии).
- - **Узловые точки** (опорники, башни, огневые точки).
- - **Улучшения/модернизации** (временное → постоянное).
- 4. Стройка идёт **инженерными юнитами**; параллельность определяется числом бригад/инструмента.
### 7) Интерфейс управления (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. **Экран экономики/суточного отчёта**: баланс ресурсов, узкие места, очереди.
- 2. **Панель процентов передачи ИИ**: 5 слайдеров (LaborHours, Power, Materials, Food, CivGrowth), кнопка «сброс/по умолчанию».
- 3. **Строительное меню**: фильтры по типам зданий, требования, окупаемость, место размещения.
- 4. **Логистика**: список приказов переброски, статусы, ETA, «ускорить».
- 5. **Фортификации**: инструменты линии/точки, стоимость/время в реальном времени, очередь задач.
### 8) Данные/конфиг (JSON, no YAML) (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
### 9) Порядок суточного тика (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. **Рост населения** → рассчёт `CivGrowth`.
- 2. **Передача % ИИ** по `CivGrowth` и ресурсам (на приросте).
- 3. **Потребление базовое** (еда населения, содержание войск/зданий, потери на хранение).
- 4. **Производство зданий** (еда, материалы, энергия, труда-часы).
- 5. **Очереди строительства/обучения** (списываем труд/материалы/энергию, продвигаем прогресс).
- 6. **Логистика** (обновление статусов перебросок, прибытия/выбытия).
- 7. **Фортификации** (прогресс стройки/ремонта/износа).
- 8. **Отчёт/алерты** (дефициты, простаивающие мощности, забитые коридоры).
### 10) Дефициты и приоритеты (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. Ввести **приоритетные очереди**: 1) содержание населения/войск, 2) электропитание «жизненно важного», 3) еда военным, 4) производство, 5) исследования, 6) ускоренная логистика.
- 2. При нехватке **энергии** — пошаговое отключение по приоритетам; при нехватке **еды** — падение `CivGrowth` до 0 и рост риска событий (бунты/дезертирство), при длительном голоде — убывание населения.
- 3. Никаких «скрытых» списаний — всё видно в суточном отчёте.
### 14) Минимально жизнеспособный срез (MVP) (MUST) (Дополнение к плану разработки игры: Экономика, логистика и фортификации)
- 1. Суточный тик, 4 ресурса, один тип экономического здания (Ферма), одна Казарма, базовая передача % ИИ.
- 2. Логистика: 2 узла + 1 коридор, переброска пехотного юнита.
- 3. Фортификации: один временный (окоп) и один постоянный (бункер) тип.
- 4. Экран отчёта и слайдеры % передачи.

